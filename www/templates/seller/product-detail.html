<!--
  This template loads for the 'tab.product-detail' state (app.js)
  'product' is a $scope variable created in the productsCtrl controller (controllers.js)
  The productsCtrl pulls data from the products service (service.js)
  The products service returns an array of product data
-->

<ion-view title="{{product.name}}">
  <ion-content has-header="true" padding="true">
  <div class="row">
    <div class="col">
        <a class="button icon icon-left ion-chevron-left" href="#/products">Back</a>
    </div>
  </div>
  <div class="row row-center">
    <div class="col col-33">
          <ion-slide-box on-slide-changed="slideHasChanged($index)"  show-pager="true">
            <ion-slide ng-repeat="img in product.pictures track by $index" ng-init="updateSlider()">
              <img src="{{img.path}}" alt="{{img.label}}">
            </ion-slide>
          </ion-slide-box>
    </div>
    <div class="col col-offset-10">
        <div class="row no-padding-side">
          <div class="col left no-padding-side">
            <span class="fakebutton ion-bag">
              {{product.price}}€
            </span>
          </div>
          <div class="col right no-padding-side">
            <span class="fakebutton ion-ios7-star">
              {{product.reviewAvg}}/5
            </span>
          </div>
        </div>
        <div class="list">
          <div class="item item-divider" ng-repeat-start="feature in product.features">
            {{feature.label}}
          </div>
          <div class="item" ng-repeat-end>
            {{feature.value}}
          </div>
        </div>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <div class="item item-text-wrap">
        {{ product.name }}
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <div class="button button-light tag-item" ng-repeat="tag in product.tags">{{tag}}</div>
    </div>
  </div>

  <div class="card" ng-if="product.faq">
      <div class="item item-divider toggleMain">
        <ion-toggle>
          F.A.Q.
        </ion-toggle>
      </div>
      <div class="item item-text-wrap ng-hide toggleContent">
        <div class="item item-divider" ng-repeat-start="faq in product.faq">
          {{faq.question}}
        </div>
        <div class="item item-text-wrap" ng-repeat-end>
          <span ng-if="faq.answer != 1337">{{faq.answer}}</span>
          <div class="list" ng-if="faq.answer == 1337">
            <div class="item range range-positive">
              Couche(s)
              <input type="range" min="1" max="5" value="1" ng-model="data.couche">
              <i class="icon ion-arrow-resize"></i>{{data.couche || 1}}
            </div>
            <div class="item range range-positive">
              m²
              <input type="range" min="10" max="200" value="33" ng-model="data.metre">
              <i class="icon ion-arrow-resize"></i>{{data.metre || 33}}
            </div>
            <div class="range range-positive">
              <span class="fakebutton assertive center">Pots: {{(((data.couche || 1) * (data.metre || 33) /100) + 0.49) | number:0}}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card" ng-if="product.reviews">
      <div class="item item-divider toggleMain">
        <ion-toggle>
          <i ng-repeat="review in product.reviewAvgHtml track by $index" class="icon {{review}}"></i>
        </ion-toggle>
      </div>
      <div class="item item-text-wrap ng-hide toggleContent">
        <div ng-repeat-start="review in product.reviews track by $index" class="item item-divider">
          {{review.title}} ({{review.score}}/5) par {{review.nickname}}
        </div>
        <div class="item item-text-wrap" ng-repeat-end>
          {{review.text}}
        </div>
      </div>
    </div>

  </ion-content>
</ion-view>
